{
  "kind": "build_request",
  "title": "Assign random non-Anchor roles on game start",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-13",
      "text": "Update the backend `startGame(roomCode, hostId)` logic so that after one player is assigned `role = \"Anchor\"`, every other player in the room is assigned exactly one random role from this list and persisted in the room state: `Overly Dramatic`, `Suspicious`, `Motivational`, `Alien`, `Villain`, `Emotional`, `Reporter`, `Conspiracy`.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "After assigning one player as \"Anchor\":\n\nFor all other players in the room:\n\nAssign one random role from this list:\n\n- Overly Dramatic\n- Suspicious\n- Motivational\n- Alien\n- Villain\n- Emotional\n- Reporter\n- Conspiracy\n\nSave the role in the database.\n\nDo not change the Anchor role.\nDo not change anything else."
        ]
      },
      "acceptanceCriteria": [
        "When `startGame` is called successfully, exactly one player has `role` equal to `\"Anchor\"`.",
        "All non-Anchor players have `role` set to one of: `\"Overly Dramatic\"`, `\"Suspicious\"`, `\"Motivational\"`, `\"Alien\"`, `\"Villain\"`, `\"Emotional\"`, `\"Reporter\"`, `\"Conspiracy\"`.",
        "The Anchorâ€™s `role` value is not modified by the non-Anchor role assignment step.",
        "The assigned non-Anchor roles are persisted so that a subsequent `getRoomState(roomCode)` returns the updated `players[].role` values.",
        "No other room or player fields are changed by this update beyond what the current `startGame` already changes (e.g., do not modify `isAnchor`, `personalityCard`, `hostId`, `chatMessages`, player ordering, or validations).",
        "Role assignment for non-Anchor players does not enforce uniqueness unless it already exists in the current `startGame` behavior (duplicates are allowed)."
      ]
    }
  ],
  "constraints": [
    "Backend must remain a single Motoko actor with all logic in `backend/main.mo`.",
    "Do not introduce new user-facing text beyond what already exists; any new text (e.g., error messages) must be in English.",
    "Do not change the Anchor role assignment behavior other than adding role assignment for non-Anchor players.",
    "Do not change any other game logic, room schema, or frontend behavior."
  ],
  "nonGoals": [
    "Changing how the Anchor is selected (e.g., improving randomness for the Anchor selection).",
    "Adding new frontend UI to display or explain the newly assigned roles.",
    "Enforcing uniqueness of non-Anchor roles across players.",
    "Adding Personality Cards or any additional game phases/logic beyond role assignment."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}